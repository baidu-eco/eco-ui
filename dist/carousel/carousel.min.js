/*!  2014-09-19 */
function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}function _throw(selector,detail){throw"Carousel: selector -> ["+selector+"], details -> "+detail}function sizeGetter(dir){return"hori"==dir?{outer:"outerWidth",inner:"innerWidth",def:"width",dir:"left"}:"vert"==dir?{outer:"outerHeight",inner:"innerHeight",def:"height",dir:"top"}:void _throw(this.selector,"Function sizeGetter params error")}var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)
},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)
},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}
},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)
},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;
this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));
for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()
},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;var classes={carousel:"carousel",outer:"carousel_outer",layout:"carousel_layout",runner:"carousel_runer",index_button:"carousel_index_button",dir_button:"carousel_dir_button",pages:"carousel_pages",clicked_button:"carousel_clicked_button",disabled_button:"carousel_disabled_button",prev:"carousel_prev",next:"carousel_next"},getDefault=function(){return{view:{width:void 0,height:void 0},step:"auto",data:void 0,selector:{outer:"ul",inner:"li"},template:{outer:'<${outer} class="'+classes.carousel+'">',inner:"<${inner}>{data}</${inner}>"},indexButton:!0,isPages:!1,dirButton:!0,dirButtonAutoHide:!0,duration:300,index:0,animateType:"silde",animateDir:"hori",autoPlay:!0,autoDelay:4e3,update:function(){},onAnimateBefore:function(){},onAnimateComplete:function(){}}},carousel=function(selector,options){this.timer={},this.elems={source:$(selector)},this.selector=selector,this.def=getDefault(),this.stepMax=0,this.stepNum=1,$.extend(this.def,options);var temp=this.def.template,sr=this.def.selector;for(var k in temp)temp[k]=temp[k].replace(/\${(\w*)}/gi,sr[k]);return pri.init.call(this),this},pri={};$.extend(pri,{init:function(){(void 0==this.def.view.width||void 0==this.def.view.height)&&_throw(this.selector,"def.view");var arr=this.def.data;arr&&$.isArray(arr)?pri.printDOM.call(this):this.elems.source.find(this.def.selector.outer).wrap(pri.printRunnerLayout.call(this)),this.elems.source.find("."+classes.runner).wrap('<div class="'+classes.outer+'" style="position:relative;"><div class="'+classes.layout+" carousel_"+this.def.animateDir+'"></div></div>'),pri.storeElems.call(this),pri.updateWrapStyle.call(this),pri.getStepNum.call(this),pri.printButtons.call(this),pri.bindEvent.call(this),this.def.update.call(this,this.elems)},printDOM:function(){for(var arr=this.def.data,temp=this.def.template,dom_arr=[temp.outer],i=0;i<arr.length;i++)dom_arr.push(temp.inner.replace(/{(\w*)}/i,function(w,d){return arr[i][d]}));dom_arr.push(temp.outer.replace(/^</,"</")),this.elems.source.html(pri.printRunnerLayout.call(this,dom_arr.join("")))},storeElems:function(){this.elems.outer=this.elems.source.find("."+classes.outer),this.elems.layout=this.elems.source.find("."+classes.layout),this.elems.runner=this.elems.source.find("."+classes.runner),this.elems.list=this.elems.runner.find(this.def.selector.inner),this.elems.dirButton=null,this.elems.indexButton=null,this.elems.pages=null},updateWrapStyle:function(){var getter=sizeGetter.call(this,this.def.animateDir);if("auto"==this.def.step&&(this.def.step=this.def.view[getter.def]),"hori"==this.def.animateDir){var runner_size=0;this.elems.list.each(function(){runner_size+=Number($(this)[getter.outer](!0))}),this.elems.runner[getter.def](runner_size)}this.elems.layout.css(this.def.view),this.elems.outer.css(this.def.view),this.stepMax=this.def.view[getter.def]-runner_size},getStepNum:function(){var getter=sizeGetter.call(this,this.def.animateDir),first=this.elems.list.eq(0)[getter.outer](),num=Math.round(this.def.view[getter.def]/first);this.stepNum=num},printButtons:function(){var getter=sizeGetter.call(this,this.def.animateDir),dom_arr=[],size=this.elems.runner[getter.outer](),len=Math.round(size/this.def.step-(this.def.view[getter.def]-this.def.step)/this.def.step);isNaN(len)&&(len=this.elems.list.length);var hidden_style="";this.elems.source.find("."+classes.index_button).length||(this.elems.layout.after("<div "+hidden_style+' class="'+classes.index_button+'"></div>'),this.elems.indexButton=this.elems.source.find("."+classes.index_button));for(var i=0;len>i;i++)dom_arr.push('<span to="'+i+'"><em>'+(i+1)+"</em></span>");this.elems.indexButton.html(dom_arr.join("")),this.elems.source.find("."+classes.dir_button).length||(this.def.dirButtonAutoHide&&(hidden_style='style="display: none;"'),this.elems.layout.after("<div "+hidden_style+' class="'+classes.dir_button+'"></div>'),this.elems.dirButton=this.elems.source.find("."+classes.dir_button),this.elems.dirButton.html('<span to="prev" class="'+classes.prev+'"><em></em></span><span to="next" class="'+classes.next+'"><em></em></span>')),this.def.isPages&&(this.elems.layout.after('<div class="'+classes.pages+'"><span>1</span><em>/</em><span>'+this.elems.list.length+"</span></div>"),this.elems.pages=this.elems.source.find("."+classes.pages)),(!this.def.indexButton||this.stepMax>=0)&&this.elems.indexButton.hide(),(!this.def.dirButton||this.stepMax>=0)&&this.elems.dirButton.hide()},printRunnerLayout:function(str){return'<div class="'+classes.runner+'">'+(str||"")+"</div>"},play:{start:function(){clearInterval(this.timer.play);var _this=this;this.timer.play=null,this.timer.play=setInterval(function(){_this.elems.dirButton.find("span."+classes.next).trigger("click.carousel")},this.def.autoDelay)},stop:function(){clearInterval(this.timer.play)}},bindEvent:function(){var _this=this;this.elems.indexButton.delegate("span","mouseover.carousel",function(){if(!$(this).hasClass(classes.clicked_button)){var to=$(this).attr("to");to=Number(to);var is_nan=isNaN(to),index=null,elem=null;0==is_nan?index=Number(to):_throw(_this.selector,"index button {attr=to} type error"),elem=_this.elems.list.eq(to),_this.def.onAnimateBefore.call(_this,_this.elems.runner),_this.animate(index,elem),pri.updateButtonStyle.call(_this,this)}}),this.elems.indexButton.find("span").eq(this.def.index).trigger("mouseover.carousel"),this.elems.dirButton.delegate("span","click.carousel",function(){var $cur_index_button=_this.elems.indexButton.find("span."+classes.clicked_button),type=$(this).attr("to"),$to_index_button=$cur_index_button[type]();"next"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(0)),"prev"!=type||$to_index_button.length||($to_index_button=_this.elems.indexButton.find("span").eq(_this.elems.indexButton.find("span").length-1)),$to_index_button.trigger("mouseover.carousel")}),this.def.autoPlay&&(pri.play.start.call(this),this.elems.layout.hover(function(){pri.play.stop.call(_this)},function(){pri.play.start.call(_this)})),this.def.dirButton&&this.def.dirButtonAutoHide&&this.stepMax<0&&this.elems.outer.hover(function(){pri.buttonEffect.dir.call(_this,"fadeIn")},function(){pri.buttonEffect.dir.call(_this,"fadeOut")})},buttonEffect:{dir:function(type,delay){clearTimeout(this.timer.dirbtn);var _this=this,delay=delay||100;this.timer.dirbtn=null,this.timer.dirbtn=setTimeout(function(){_this.elems.dirButton[type](100)},delay)}},updateButtonStyle:function(clicked_button){$(clicked_button).addClass(classes.clicked_button),$(clicked_button).siblings().removeClass(classes.clicked_button)},update:function(){}}),$.extend(carousel.prototype,{update:function(method){method.call(pri.update.call(this))},updatePages:function(index){var index_arr=[],i=index*this.stepNum;return index_arr.push(i),this.stepNum>1&&index_arr.push(index_arr[0]+this.stepNum-1),this.def.isPages&&this.elems.pages.find("span").eq(0).html(index_arr[0]+1+"-"+(index_arr[1]+1)),index_arr},animate:function(index,elem){var method=this.effect[this.def.animateType];if(void 0!==method){var index_arr=this.updatePages(index,elem);method.call(this,index,elem,index_arr)}else _throw(this.selector,"animateType ["+this.def.animateType+"] unkown.")},effect:{fade:function(index,elem,index_arr){var elem=this.elems.list.eq(index);elem.fadeIn(this.def.duration),elem.siblings().hide(),this.def.onAnimateComplete.call(this,this.elems.runner,index_arr)},silde:function(index,elem,index_arr){var _this=this,end=this.def.step*index*-1,getter=sizeGetter.call(this,this.def.animateDir),ani_params={};ani_params[getter.dir]=Math.abs(end)>Math.abs(this.stepMax)?this.stepMax:end,this.elems.runner.stop().animate(ani_params,{duration:this.def.duration,complete:function(){_this.def.onAnimateComplete.call(_this,_this.elems.runner,index_arr)}})}}}),module.exports=carousel;